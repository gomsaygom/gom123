<!DOCTYPE html>
<meta charset="utf-8" />
<title>Chat quick test</title>
<div>roomId: <input id="roomId" style="width:360px" value="6925d070f002f1c2640704fb"></div>
<div style="margin-top:8px;">
  senderId: <input id="senderId" value="1">
  message: <input id="msg" style="width:260px">
  <button id="send">보내기</button>
</div>
<pre id="log" style="border:1px solid #ccc;height:200px;overflow:auto;margin-top:8px;padding:6px"></pre>

<script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
<script>
const BASE_URL = "http://180.92.115.74:4000";
const $ = s => document.querySelector(s);
const log = m => { $("#log").textContent += m+"\n"; $("#log").scrollTop = $("#log").scrollHeight; };

const socket = io(BASE_URL);
socket.on("connect", ()=>log("connected: "+socket.id));
socket.on("newMessage", m => log("[recv] "+JSON.stringify(m)));
socket.on("errorMessage", e => log("[error] "+JSON.stringify(e)));

const join = () => socket.emit("joinRoom", { roomId: $("#roomId").value.trim() });
join();

$("#send").onclick = () => {
  const roomId = $("#roomId").value.trim();
  const senderId = $("#senderId").value.trim(); // "1"|"2"|"3" 중 하나
  const content = $("#msg").value.trim();
  socket.emit("sendMessage", { roomId, senderId, content });
  log("[send] "+JSON.stringify({ roomId, senderId, content }));
  $("#msg").value = "";
};
</script>
